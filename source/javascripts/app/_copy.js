function copyToClipboard(container) {
  const el = document.createElement('textarea');
  el.value = container.textContent.replace(/\n$/, '');
  document.body.appendChild(el);
  el.select();
  document.execCommand('copy');
  document.body.removeChild(el);
}

function setupCodeCopy() {
  $('pre.highlight').prepend('<div class="copy-clipboard"><svg width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M5.12759 3.68483C4.87751 3.68483 4.63766 3.78418 4.46083 3.96101C4.28399 4.13785 4.18465 4.37769 4.18465 4.62777V12.3029C4.18465 12.553 4.28399 12.7928 4.46083 12.9696C4.63766 13.1465 4.87751 13.2458 5.12759 13.2458H6.07053V7.69781C6.07053 6.52305 7.02286 5.57071 8.19763 5.57071H13.7456V4.62777C13.7456 4.37769 13.6463 4.13785 13.4695 3.96101C13.2926 3.78418 13.0528 3.68483 12.8027 3.68483H5.12759ZM14.9298 5.57071V4.62777C14.9298 4.06363 14.7057 3.52259 14.3068 3.12368C13.9079 2.72478 13.3668 2.50067 12.8027 2.50067H5.12759C4.56345 2.50067 4.02241 2.72478 3.6235 3.12368C3.22459 3.52259 3.00049 4.06363 3.00049 4.62777V12.3029C3.00049 12.867 3.22459 13.4081 3.6235 13.807C4.02241 14.2059 4.56345 14.43 5.12759 14.43H6.07053V15.3729C6.07053 16.5477 7.02286 17.5 8.19763 17.5H15.8727C17.0475 17.5 17.9998 16.5477 17.9998 15.3729V7.69781C17.9998 6.52305 17.0475 5.57071 15.8727 5.57071H14.9298ZM14.337 6.75487C14.3372 6.75487 14.3375 6.75487 14.3377 6.75487C14.338 6.75487 14.3382 6.75487 14.3385 6.75487H15.8727C16.3935 6.75487 16.8157 7.17704 16.8157 7.69781V15.3729C16.8157 15.8937 16.3935 16.3159 15.8727 16.3159H8.19763C7.67686 16.3159 7.25469 15.8937 7.25469 15.3729V13.8387C7.25469 13.8384 7.25469 13.8381 7.25469 13.8379C7.25469 13.8376 7.25469 13.8374 7.25469 13.8371V7.69781C7.25469 7.17704 7.67686 6.75487 8.19763 6.75487H14.337Z" fill="#1AD1DB"/></svg><span class="copy-clipboard-text">Copy</span></div>');
  $('.copy-clipboard').on('click', function() {
    copyToClipboard(this.parentNode.children[1]);
  });
  $('.http-method.delete').prepend('<div class="http-method-copy"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path fill-rule="evenodd" clip-rule="evenodd" d="M4.16488 3.31632C3.9398 3.31632 3.72395 3.40573 3.56479 3.56489C3.40564 3.72404 3.31623 3.9399 3.31623 4.16497V11.0726C3.31623 11.2976 3.40564 11.5135 3.56479 11.6726C3.72395 11.8318 3.9398 11.9212 4.16488 11.9212H5.01353V6.92801C5.01353 5.87072 5.87063 5.01362 6.92792 5.01362H11.9211V4.16497C11.9211 3.9399 11.8317 3.72404 11.6726 3.56489C11.5134 3.40573 11.2975 3.31632 11.0725 3.31632H4.16488ZM12.9869 5.01362V4.16497C12.9869 3.65724 12.7852 3.17031 12.4262 2.81129C12.0671 2.45227 11.5802 2.25058 11.0725 2.25058H4.16488C3.65715 2.25058 3.17022 2.45227 2.8112 2.81129C2.45218 3.17031 2.25049 3.65724 2.25049 4.16497V11.0726C2.25049 11.5803 2.45218 12.0672 2.8112 12.4262C3.17022 12.7853 3.65715 12.987 4.16488 12.987H5.01353V13.8356C5.01353 14.8929 5.87063 15.75 6.92792 15.75H13.8355C14.8928 15.75 15.7499 14.8929 15.7499 13.8356V6.92801C15.7499 5.87072 14.8928 5.01362 13.8355 5.01362H12.9869ZM12.4533 6.07936C12.4535 6.07936 12.4538 6.07936 12.454 6.07936C12.4542 6.07936 12.4544 6.07936 12.4547 6.07936H13.8355C14.3042 6.07936 14.6842 6.45931 14.6842 6.92801V13.8356C14.6842 14.3043 14.3042 14.6842 13.8355 14.6842H6.92792C6.45922 14.6842 6.07927 14.3043 6.07927 13.8356V12.4548C6.07927 12.4545 6.07927 12.4543 6.07927 12.4541C6.07927 12.4539 6.07927 12.4536 6.07927 12.4534V6.92801C6.07927 6.45931 6.45922 6.07936 6.92792 6.07936H12.4533Z" fill="#C3205E"/></svg></div>');

  $('.http-method.get').prepend('<div class="http-method-copy"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path fill-rule="evenodd" clip-rule="evenodd" d="M4.16488 3.31635C3.9398 3.31635 3.72395 3.40576 3.56479 3.56492C3.40564 3.72407 3.31623 3.93993 3.31623 4.165V11.0726C3.31623 11.2977 3.40564 11.5135 3.56479 11.6727C3.72395 11.8318 3.9398 11.9212 4.16488 11.9212H5.01353V6.92804C5.01353 5.87075 5.87063 5.01365 6.92792 5.01365H11.9211V4.165C11.9211 3.93993 11.8317 3.72407 11.6726 3.56492C11.5134 3.40576 11.2975 3.31635 11.0725 3.31635H4.16488ZM12.9869 5.01365V4.165C12.9869 3.65727 12.7852 3.17034 12.4262 2.81132C12.0671 2.4523 11.5802 2.25061 11.0725 2.25061H4.16488C3.65715 2.25061 3.17022 2.4523 2.8112 2.81132C2.45218 3.17034 2.25049 3.65727 2.25049 4.165V11.0726C2.25049 11.5803 2.45218 12.0673 2.8112 12.4263C3.17022 12.7853 3.65715 12.987 4.16488 12.987H5.01353V13.8356C5.01353 14.8929 5.87063 15.75 6.92792 15.75H13.8355C14.8928 15.75 15.7499 14.8929 15.7499 13.8356V6.92804C15.7499 5.87075 14.8928 5.01365 13.8355 5.01365H12.9869ZM12.4533 6.07939C12.4535 6.07939 12.4538 6.07939 12.454 6.07939C12.4542 6.07939 12.4544 6.07939 12.4547 6.07939H13.8355C14.3042 6.07939 14.6842 6.45934 14.6842 6.92804V13.8356C14.6842 14.3043 14.3042 14.6843 13.8355 14.6843H6.92792C6.45922 14.6843 6.07927 14.3043 6.07927 13.8356V12.4548C6.07927 12.4546 6.07927 12.4543 6.07927 12.4541C6.07927 12.4539 6.07927 12.4537 6.07927 12.4534V6.92804C6.07927 6.45934 6.45922 6.07939 6.92792 6.07939H12.4533Z" fill="#009FA9"/></svg></div>');

  $('.http-method.post').prepend('<div class="http-method-copy"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path fill-rule="evenodd" clip-rule="evenodd" d="M4.16488 3.31632C3.9398 3.31632 3.72395 3.40573 3.56479 3.56489C3.40564 3.72404 3.31623 3.9399 3.31623 4.16497V11.0726C3.31623 11.2976 3.40564 11.5135 3.56479 11.6726C3.72395 11.8318 3.9398 11.9212 4.16488 11.9212H5.01353V6.92801C5.01353 5.87072 5.87063 5.01362 6.92792 5.01362H11.9211V4.16497C11.9211 3.9399 11.8317 3.72404 11.6726 3.56489C11.5134 3.40573 11.2975 3.31632 11.0725 3.31632H4.16488ZM12.9869 5.01362V4.16497C12.9869 3.65724 12.7852 3.17031 12.4262 2.81129C12.0671 2.45227 11.5802 2.25058 11.0725 2.25058H4.16488C3.65715 2.25058 3.17022 2.45227 2.8112 2.81129C2.45218 3.17031 2.25049 3.65724 2.25049 4.16497V11.0726C2.25049 11.5803 2.45218 12.0672 2.8112 12.4262C3.17022 12.7853 3.65715 12.987 4.16488 12.987H5.01353V13.8356C5.01353 14.8929 5.87063 15.75 6.92792 15.75H13.8355C14.8928 15.75 15.7499 14.8929 15.7499 13.8356V6.92801C15.7499 5.87072 14.8928 5.01362 13.8355 5.01362H12.9869ZM12.4533 6.07936C12.4535 6.07936 12.4538 6.07936 12.454 6.07936C12.4542 6.07936 12.4544 6.07936 12.4547 6.07936H13.8355C14.3042 6.07936 14.6842 6.45931 14.6842 6.92801V13.8356C14.6842 14.3043 14.3042 14.6842 13.8355 14.6842H6.92792C6.45922 14.6842 6.07927 14.3043 6.07927 13.8356V12.4548C6.07927 12.4545 6.07927 12.4543 6.07927 12.4541C6.07927 12.4539 6.07927 12.4536 6.07927 12.4534V6.92801C6.07927 6.45931 6.45922 6.07936 6.92792 6.07936H12.4533Z" fill="#009273"/></svg></div>');

  $('.http-method.put').prepend('<div class="http-method-copy"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path fill-rule="evenodd" clip-rule="evenodd" d="M4.16488 3.31632C3.9398 3.31632 3.72395 3.40573 3.56479 3.56489C3.40564 3.72404 3.31623 3.9399 3.31623 4.16497V11.0726C3.31623 11.2976 3.40564 11.5135 3.56479 11.6726C3.72395 11.8318 3.9398 11.9212 4.16488 11.9212H5.01353V6.92801C5.01353 5.87072 5.87063 5.01362 6.92792 5.01362H11.9211V4.16497C11.9211 3.9399 11.8317 3.72404 11.6726 3.56489C11.5134 3.40573 11.2975 3.31632 11.0725 3.31632H4.16488ZM12.9869 5.01362V4.16497C12.9869 3.65724 12.7852 3.17031 12.4262 2.81129C12.0671 2.45227 11.5802 2.25058 11.0725 2.25058H4.16488C3.65715 2.25058 3.17022 2.45227 2.8112 2.81129C2.45218 3.17031 2.25049 3.65724 2.25049 4.16497V11.0726C2.25049 11.5803 2.45218 12.0672 2.8112 12.4262C3.17022 12.7853 3.65715 12.987 4.16488 12.987H5.01353V13.8356C5.01353 14.8929 5.87063 15.75 6.92792 15.75H13.8355C14.8928 15.75 15.7499 14.8929 15.7499 13.8356V6.92801C15.7499 5.87072 14.8928 5.01362 13.8355 5.01362H12.9869ZM12.4533 6.07936C12.4535 6.07936 12.4538 6.07936 12.454 6.07936C12.4542 6.07936 12.4544 6.07936 12.4547 6.07936H13.8355C14.3042 6.07936 14.6842 6.45931 14.6842 6.92801V13.8356C14.6842 14.3043 14.3042 14.6842 13.8355 14.6842H6.92792C6.45922 14.6842 6.07927 14.3043 6.07927 13.8356V12.4548C6.07927 12.4545 6.07927 12.4543 6.07927 12.4541C6.07927 12.4539 6.07927 12.4536 6.07927 12.4534V6.92801C6.07927 6.45931 6.45922 6.07936 6.92792 6.07936H12.4533Z" fill="#009273"/></svg></div>');

  $('code.code-copy').prepend('<div class="code-text-copy"><svg width="18" height="19" viewBox="0 0 18 19" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.16488 3.81633C3.9398 3.81633 3.72395 3.90574 3.56479 4.06489C3.40564 4.22405 3.31623 4.4399 3.31623 4.66498V11.5726C3.31623 11.7976 3.40564 12.0135 3.56479 12.1727C3.72395 12.3318 3.9398 12.4212 4.16488 12.4212H5.01353V7.42802C5.01353 6.37073 5.87063 5.51362 6.92792 5.51362H11.9211V4.66498C11.9211 4.4399 11.8317 4.22405 11.6726 4.06489C11.5134 3.90574 11.2975 3.81633 11.0725 3.81633H4.16488ZM12.9869 5.51362V4.66498C12.9869 4.15725 12.7852 3.67032 12.4262 3.3113C12.0671 2.95228 11.5802 2.75059 11.0725 2.75059H4.16488C3.65715 2.75059 3.17022 2.95228 2.8112 3.3113C2.45218 3.67032 2.25049 4.15725 2.25049 4.66498V11.5726C2.25049 12.0803 2.45218 12.5672 2.8112 12.9263C3.17022 13.2853 3.65715 13.487 4.16488 13.487H5.01353V14.3356C5.01353 15.3929 5.87063 16.25 6.92792 16.25H13.8355C14.8928 16.25 15.7499 15.3929 15.7499 14.3356V7.42802C15.7499 6.37073 14.8928 5.51362 13.8355 5.51362H12.9869ZM12.4533 6.57937C12.4535 6.57937 12.4538 6.57937 12.454 6.57937C12.4542 6.57937 12.4544 6.57937 12.4547 6.57937H13.8355C14.3042 6.57937 14.6842 6.95932 14.6842 7.42802V14.3356C14.6842 14.8043 14.3042 15.1843 13.8355 15.1843H6.92792C6.45922 15.1843 6.07927 14.8043 6.07927 14.3356V12.9548C6.07927 12.9545 6.07927 12.9543 6.07927 12.9541C6.07927 12.9539 6.07927 12.9536 6.07927 12.9534V7.42802C6.07927 6.95932 6.45922 6.57937 6.92792 6.57937H12.4533Z" fill="#2D2F4A"/></svg></div>');
  
  $('.http-method-copy').on('click', function() {
    copyToClipboard(this.parentNode.children[2]);
  });
  $('.code-text-copy').on('click', function() {
    copyToClipboard(this.parentNode.children[1]);
  });
}
